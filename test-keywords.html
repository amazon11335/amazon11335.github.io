<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å…³é”®è¯æ£€æµ‹æµ‹è¯•</title>
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/components.css">
</head>
<body>
    <div class="container">
        <h1>ğŸ” å…³é”®è¯æ£€æµ‹å¼•æ“æµ‹è¯•</h1>
        
        <div class="card">
            <h3>æµ‹è¯•è¾“å…¥</h3>
            <textarea id="testInput" placeholder="è¾“å…¥æµ‹è¯•æ–‡æœ¬..." rows="4" style="width: 100%; margin-bottom: 15px;"></textarea>
            <button class="btn btn-primary" onclick="testDetection()">å¼€å§‹æ£€æµ‹</button>
            <button class="btn btn-success" onclick="loadTestCases()">åŠ è½½æµ‹è¯•ç”¨ä¾‹</button>
        </div>

        <div class="card">
            <h3>æ£€æµ‹ç»“æœ</h3>
            <div id="testResults"></div>
        </div>

        <div class="card">
            <h3>å…³é”®è¯åº“ç»Ÿè®¡</h3>
            <div id="keywordStats"></div>
        </div>

        <div class="card">
            <h3>é¢„è®¾æµ‹è¯•ç”¨ä¾‹</h3>
            <div class="test-cases">
                <button class="btn btn-outline" onclick="testCase('å åœå¤§å¸ˆå…è´¹ç®—å‘½ï¼Œå‡†ç¡®ç‡99%ï¼Œè½¬è¿æ”¹å‘½åªéœ€998å…ƒ')">å åœè¯ˆéª—æµ‹è¯•</button>
                <button class="btn btn-outline" onclick="testCase('æŠ•èµ„ç†è´¢ç¨³èµšä¸èµ”ï¼Œå†…å¹•æ¶ˆæ¯æ—¥èµšåƒå…ƒï¼Œä¿æœ¬ä¿æ¯')">æŠ•èµ„è¯ˆéª—æµ‹è¯•</button>
                <button class="btn btn-outline" onclick="testCase('æˆ‘æ˜¯å…¬å®‰å±€çš„ï¼Œä½ æ¶‰å«Œæ´—é’±ï¼Œéœ€è¦é…åˆè°ƒæŸ¥ï¼Œè¯·è½¬è´¦åˆ°å®‰å…¨è´¦æˆ·')">èº«ä»½å†’å……æµ‹è¯•</button>
                <button class="btn btn-outline" onclick="testCase('äº²çˆ±çš„ï¼Œæˆ‘åœ¨å›½å¤–é‡åˆ°å›°éš¾ï¼Œæ€¥éœ€ç”¨é’±ï¼Œè¯·é©¬ä¸Šè½¬è´¦æ•‘æˆ‘')">æƒ…æ„Ÿè¯ˆéª—æµ‹è¯•</button>
                <button class="btn btn-outline" onclick="testCase('ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œå‡†å¤‡å»å…¬å›­æ•£æ­¥')">æ­£å¸¸å†…å®¹æµ‹è¯•</button>
            </div>
        </div>
    </div>

    <script src="js/keywords-database.js"></script>
    <script>
        function testDetection() {
            const input = document.getElementById('testInput').value.trim();
            if (!input) {
                alert('è¯·è¾“å…¥æµ‹è¯•æ–‡æœ¬');
                return;
            }
            
            const result = keywordDetector.detectRisk(input);
            displayResults(result, input);
        }

        function testCase(text) {
            document.getElementById('testInput').value = text;
            const result = keywordDetector.detectRisk(text);
            displayResults(result, text);
        }

        function displayResults(result, originalText) {
            const resultsDiv = document.getElementById('testResults');
            
            const riskLevelColors = {
                'safe': '#27ae60',
                'low': '#f39c12', 
                'medium': '#e67e22',
                'high': '#e74c3c',
                'critical': '#8b0000'
            };

            const keywordTags = result.matchedKeywords.map(keyword => 
                `<span class="tag tag-danger">${keyword}</span>`
            ).join('');

            const typesList = result.detectedTypes.map(type => 
                `<li><strong>${type.name}</strong> - åŒ¹é…: ${type.matches.join(', ')} (å¾—åˆ†: ${type.score})</li>`
            ).join('');

            const suggestionsList = result.suggestions.map(suggestion => 
                `<li>${suggestion}</li>`
            ).join('');

            resultsDiv.innerHTML = `
                <div style="border-left: 4px solid ${riskLevelColors[result.riskLevel]}; padding: 15px; margin: 10px 0; background: #f8f9fa;">
                    <h4>æ£€æµ‹æ–‡æœ¬ï¼š</h4>
                    <p style="background: #fff; padding: 10px; border-radius: 5px; margin: 10px 0;">${originalText}</p>
                    
                    <h4>é£é™©è¯„ä¼°ï¼š</h4>
                    <p><strong>æ€»åˆ†ï¼š</strong> ${result.totalScore}</p>
                    <p><strong>é£é™©ç­‰çº§ï¼š</strong> <span style="color: ${riskLevelColors[result.riskLevel]}; font-weight: bold;">${result.riskLevel.toUpperCase()}</span></p>
                    
                    <h4>åŒ¹é…å…³é”®è¯ï¼š</h4>
                    <div class="tag-container">${keywordTags || 'æ— '}</div>
                    
                    <h4>æ£€æµ‹åˆ°çš„è¯ˆéª—ç±»å‹ï¼š</h4>
                    <ul>${typesList || '<li>æ— æ£€æµ‹åˆ°è¯ˆéª—ç±»å‹</li>'}</ul>
                    
                    <h4>å®‰å…¨å»ºè®®ï¼š</h4>
                    <ul>${suggestionsList}</ul>
                    
                    <p><strong>æ£€æµ‹æ—¶é—´ï¼š</strong> ${new Date().toLocaleString()}</p>
                </div>
            `;
        }

        function loadTestCases() {
            const testCases = [
                'å åœå¤§å¸ˆå…è´¹ç®—å‘½ï¼Œå‡†ç¡®ç‡99%ï¼Œè½¬è¿æ”¹å‘½åªéœ€998å…ƒ',
                'æŠ•èµ„ç†è´¢ç¨³èµšä¸èµ”ï¼Œå†…å¹•æ¶ˆæ¯æ—¥èµšåƒå…ƒï¼Œä¿æœ¬ä¿æ¯',
                'æˆ‘æ˜¯å…¬å®‰å±€çš„ï¼Œä½ æ¶‰å«Œæ´—é’±ï¼Œéœ€è¦é…åˆè°ƒæŸ¥ï¼Œè¯·è½¬è´¦åˆ°å®‰å…¨è´¦æˆ·',
                'äº²çˆ±çš„ï¼Œæˆ‘åœ¨å›½å¤–é‡åˆ°å›°éš¾ï¼Œæ€¥éœ€ç”¨é’±ï¼Œè¯·é©¬ä¸Šè½¬è´¦æ•‘æˆ‘',
                'å…¼èŒåˆ·å•æ—¥èµš300ï¼Œå…ˆäº¤ä¿è¯é‡‘500å…ƒï¼Œå®Œæˆä»»åŠ¡åè¿”è¿˜',
                'æ…ˆå–„å‹Ÿææ•‘åŠ©è´«å›°å„¿ç«¥ï¼Œè¯·è½¬è´¦åˆ°æŒ‡å®šè´¦æˆ·çŒ®çˆ±å¿ƒ',
                'ä»Šå¤©å¤©æ°”ä¸é”™ï¼Œå‡†å¤‡å»å…¬å›­æ•£æ­¥'
            ];

            let results = '<h4>æ‰¹é‡æµ‹è¯•ç»“æœï¼š</h4>';
            testCases.forEach((testCase, index) => {
                const result = keywordDetector.detectRisk(testCase);
                results += `
                    <div style="margin: 10px 0; padding: 10px; border: 1px solid #ddd; border-radius: 5px;">
                        <p><strong>æµ‹è¯•${index + 1}ï¼š</strong>${testCase}</p>
                        <p><strong>é£é™©ç­‰çº§ï¼š</strong> ${result.riskLevel} (${result.totalScore}åˆ†)</p>
                        <p><strong>åŒ¹é…å…³é”®è¯ï¼š</strong> ${result.matchedKeywords.join(', ') || 'æ— '}</p>
                    </div>
                `;
            });

            document.getElementById('testResults').innerHTML = results;
        }

        function displayKeywordStats() {
            const stats = keywordDetector.getStatistics();
            const statsDiv = document.getElementById('keywordStats');
            
            let statsHtml = '<h4>å…³é”®è¯åº“ç»Ÿè®¡ï¼š</h4>';
            for (const [type, data] of Object.entries(stats)) {
                statsHtml += `
                    <div style="margin: 10px 0; padding: 10px; background: #f8f9fa; border-radius: 5px;">
                        <p><strong>${data.name}</strong></p>
                        <p>å…³é”®è¯æ•°é‡: ${data.keywordCount}</p>
                        <p>æƒé‡: ${data.weight}</p>
                    </div>
                `;
            }
            
            const totalKeywords = Object.values(stats).reduce((sum, data) => sum + data.keywordCount, 0);
            statsHtml += `<p><strong>æ€»å…³é”®è¯æ•°é‡ï¼š</strong> ${totalKeywords}</p>`;
            
            statsDiv.innerHTML = statsHtml;
        }

        // é¡µé¢åŠ è½½æ—¶æ˜¾ç¤ºç»Ÿè®¡ä¿¡æ¯
        window.addEventListener('load', function() {
            displayKeywordStats();
        });
    </script>
</body>
</html>